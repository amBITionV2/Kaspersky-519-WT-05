echo '{% extends "base.html" %}
{% block head_extra %}
<style>
.dashboard-subnav {
  background: var(--panel-color);
  border-bottom: 1px solid var(--border-color);
  padding: 0.75rem 0;
}

.subnav-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 1rem;
  display: flex;
  gap: 0;
  overflow-x: auto;
}

.subnav-item {
  display: inline-flex;
  align-items: center;
  padding: 0.75rem 1.5rem;
  text-decoration: none;
  color: var(--text-muted);
  font-weight: 500;
  border-bottom: 3px solid transparent;
  transition: all 0.3s ease;
}

.subnav-item:hover {
  color: var(--accent-color);
}

.subnav-item.active {
  color: var(--accent-color);
  border-bottom-color: var(--accent-color);
}

.dashboard-section {
  display: none;
}

.dashboard-section.active {
  display: block;
}

.stat-card {
  background: var(--panel-color);
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius);
  padding: 1.5rem;
  text-align: center;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.75rem;
}

.stat-card .stat-icon {
  font-size: 2.5rem;
  color: var(--accent-color);
  margin-bottom: 0.5rem;
}

.stat-card h4 {
  margin: 0;
  font-size: 0.9rem;
  color: var(--text-muted);
}

.stat-card .value {
  font-size: 2rem;
  font-weight: 800;
  color: var(--accent-color);
  margin: 0;
}

.stats-horizontal {
  display: grid;
  gap: 1rem;
  grid-template-columns: repeat(2, 1fr);
}

.reputation-display {
  text-align: center;
}

.score-large {
  font-size: 3rem;
  font-weight: 800;
  color: var(--accent-color);
  margin-bottom: 1rem;
}

.rep-breakdown p {
  margin: 0.5rem 0;
  color: var(--text-muted);
}

@media (max-width: 768px) {
  .stats-horizontal {
    grid-template-columns: 1fr;
  }
}
</style>
{% endblock %}

{% block content %}
  <div class="dashboard">
    <!-- Top Navigation Bar -->
    <nav class="dashboard-nav">
      <div class="nav-container">
        <h3 style="margin:0; color: var(--primary-color);">Welcome, {{ current_user.full_name or current_user.username }}</h3>
        <div class="nav-buttons">
        </div>
      </div>
    </nav>

    <!-- Sub Navigation Bar -->
    <nav class="dashboard-subnav">
      <div class="subnav-container">
        <a href="#main-dashboard" class="subnav-item active">Dashboard</a>
        <a href="#profile" class="subnav-item">My Profile</a>
        <a href="#requests" class="subnav-item">My Requests</a>
        <a href="#offers" class="subnav-item">My Offers</a>
        <a href="#reviews" class="subnav-item">My Reviews</a>
        <a href="#reputation" class="subnav-item">Reputation Score</a>
      </div>
    </nav>

    <div class="dashboard-content">
      <!-- Main Dashboard Stats (shown by default) -->
      <div id="main-dashboard" class="dashboard-section active">
        <div class="stats-horizontal">
          <div class="stat-card">
            <div class="stat-icon">
              <i class="fa-solid fa-clipboard-list"></i>
            </div>
            <h4>Total requests created</h4>
            <div class="value">{{ stats.total_requests }}</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">
              <i class="fa-solid fa-hand-holding-heart"></i>
            </div>
            <h4>Total help offers made</h4>
            <div class="value">{{ stats.total_offers }}</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">
              <i class="fa-solid fa-star"></i>
            </div>
            <h4>Current reputation score</h4>
            <div class="value">{{ "%.1f"|format(stats.reputation) }}</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">
              <i class="fa-solid fa-clock"></i>
            </div>
            <h4>Pending tasks</h4>
            <div class="value">{{ stats.pending_tasks }}</div>
          </div>
        </div>

        <div class="section" id="recent">
          <h3>Recent Activity</h3>
          {% if recent.requests or recent.offers %}
            <ul>
              {% for r in recent.requests %}
                <li><strong>Request:</strong> {{ r.title }} - {{ r.status }}</li>
              {% endfor %}
              {% for o in recent.offers %}
                <li><strong>Offer:</strong> on request #{{ o.request_id }} - {{ o.status }}</li>
              {% endfor %}
            </ul>
          {% else %}
            <p class="muted">No recent activity yet.</p>
          {% endif %}
        </div>
      </div>

      <!-- My Profile Section -->
      <div id="profile" class="dashboard-section">
        <div class="section">
          <h3>My Profile</h3>
          <p><strong>Name:</strong> {{ current_user.full_name or current_user.username }}</p>
          <p><strong>Email:</strong> {{ current_user.email }}</p>
          {% if current_user.bio %}
            <p><strong>Bio:</strong> {{ current_user.bio }}</p>
          {% endif %}
          {% if current_user.skills %}
            <p><strong>Skills:</strong> {{ current_user.skills }}</p>
          {% endif %}
          <p><strong>Location:</strong> {{ current_user.location or "Not set" }}</p>
          <p><strong>Joined:</strong> {{ current_user.created_at.strftime("%B %Y") }}</p>
          <div class="actions">
            <a class="btn" href="{{ url_for("profile_edit") }}">Edit Profile</a>
          </div>
        </div>
      </div>

      <!-- My Requests Section -->
      <div id="requests" class="dashboard-section">
        <div class="section">
          <h3>My Requests</h3>
          {% if recent.requests %}
            <ul>
              {% for r in recent.requests %}
                <li><strong>{{ r.title }}</strong> - {{ r.status }} - {{ r.created_at.strftime("%Y-%m-%d") }}</li>
              {% endfor %}
            </ul>
          {% else %}
            <p>No requests made so far</p>
            <a class="btn btn-spaced" href="{{ url_for("request_help") }}">Create Your First Request</a>
          {% endif %}
        </div>
      </div>

      <!-- My Offers Section -->
      <div id="offers" class="dashboard-section">
        <div class="section">
          <h3>My Offers</h3>
          {% if recent.offers %}
            <ul>
              {% for o in recent.offers %}
                <li><strong>Offer on Request #{{ o.request_id }}</strong> - {{ o.status }}</li>
              {% endfor %}
            </ul>
          {% else %}
            <p>No offers made yet</p>
            <a class="btn btn-spaced" href="{{ url_for("marketplace") }}">Browse Available Requests</a>
          {% endif %}
        </div>
      </div>

      <!-- My Reviews Section -->
      <div id="reviews" class="dashboard-section">
        <div class="section">
          <h3>My Reviews</h3>
          <p>No reviews yet. Complete some tasks to start building your reputation!</p>
        </div>
      </div>

      <!-- Reputation Score Section -->
      <div id="reputation" class="dashboard-section">
        <div class="section">
          <h3>Reputation Score</h3>
          <div class="reputation-display">
            <div class="score-large">{{ "%.1f"|format(stats.reputation) }}/100</div>
            <div class="rep-breakdown">
              <p>Tasks Completed (Requester): {{ stats.requests_completed }}</p>
              <p>Tasks Completed (Helper): {{ stats.helps_completed }}</p>
              <p>Success Rate: {{ stats.success_rate }}%</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function() {
      const subnavItems = document.querySelectorAll(".subnav-item");
      const dashboardSections = document.querySelectorAll(".dashboard-section");

      subnavItems.forEach(item => {
        item.addEventListener("click", function(e) {
          e.preventDefault();
          const targetId = this.getAttribute("href").substring(1);

          subnavItems.forEach(nav => nav.classList.remove("active"));
          this.classList.add("active");

          dashboardSections.forEach(section => section.classList.remove("active"));
          const targetSection = document.getElementById(targetId);
          if (targetSection) {
            targetSection.classList.add("active");
          }
        });
      });

      document.getElementById("main-dashboard").classList.add("active");
    });
  </script>
{% endblock %}' > c:\Users\kavin\Kaspersky-519-WT-05\templates\dashboard.html